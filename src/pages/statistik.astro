---
// src/pages/statistik.astro
import Layout from '../layouts/Layout.astro';
const pageTitle = "Statistik Diabetes";
---

<Layout title={pageTitle}>
  <div class="max-w-5xl mx-auto py-12">
    <h1 class="mb-6 text-3xl sm:text-4xl font-bold">Statistik Diabetes Indonesia</h1>

    <!-- Summary cards -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
      <div class="p-6 rounded-lg bg-white/5">
        <div class="text-sm text-gray-300">Prevalensi saat ini</div>
        <div class="text-2xl font-semibold">11.3 %</div>
      </div>
      <div class="p-6 rounded-lg bg-white/5">
        <div class="text-sm text-gray-300">Kasus (estimasi dewasa)</div>
        <div class="text-2xl font-semibold">20.4 juta</div>
      </div>
      <div class="p-6 rounded-lg bg-white/5">
        <div class="text-sm text-gray-300">Proyeksi 2045</div>
        <div class="text-2xl font-semibold">~ 16.09 %</div>
      </div>
    </div>

    <!-- Grafik tren proyeksi prevalensi -->
    <div class="mb-10 bg-gray-900/30 rounded-lg p-4">
      <svg id="svgStatChart" viewBox="0 0 600 300" class="w-full h-64"></svg>
    </div>

    <!-- Detail data & sumber -->
    <div class="prose prose-invert">
      <h2>Detail Data</h2>
      <p>Prevalensi diabetes di Indonesia pada orang dewasa adalah sekitar <strong>11.3 %</strong>. :contentReference[oaicite:3]{index=3}</p>
      <p>Proyeksi prevalensi naik dari sekitar <strong>9.19 %</strong> di 2020 menjadi <strong>16.09 %</strong> di tahun 2045. :contentReference[oaicite:4]{index=4}</p>
      <p>Sumber global: IDF melaporkan bahwa secara global 11.1 % orang dewasa berusia 20â€“79 hidup dengan diabetes. :contentReference[oaicite:5]{index=5}</p>
    </div>
  </div>

  <script>
    // Data tren prevalensi (%)
    const years = [2020, 2025, 2030, 2035, 2040, 2045];
    const prevalence = [9.19, 10.5, 12.0, 13.5, 15.0, 16.09]; // data contoh interpolasi

    (function drawStatChart() {
      const svg = document.getElementById('svgStatChart');
      if (!svg) return;
      const w = 600, h = 300, pad = 40;
      svg.setAttribute('viewBox', `0 0 ${w} ${h}`);

      const min = Math.min(...prevalence) - 1;
      const max = Math.max(...prevalence) + 1;

      const sx = i => pad + (i * (w - pad*2) / (years.length - 1));
      const sy = v => h - pad - ((v - min) * (h - pad*2) / (max - min));

      let d = prevalence.map((v,i) => `${i===0?'M':'L'} ${sx(i)} ${sy(v)}`).join(' ');
      const path = document.createElementNS('http://www.w3.org/2000/svg','path');
      path.setAttribute('d', d);
      path.setAttribute('fill', 'none');
      path.setAttribute('stroke', '#f67280');
      path.setAttribute('stroke-width', '3');
      path.setAttribute('stroke-linejoin','round');
      path.setAttribute('stroke-linecap','round');
      svg.appendChild(path);

      // titik data
      prevalence.forEach((v,i) => {
        const cx = sx(i), cy = sy(v);
        const c = document.createElementNS('http://www.w3.org/2000/svg','circle');
        c.setAttribute('cx', cx);
        c.setAttribute('cy', cy);
        c.setAttribute('r', 4);
        c.setAttribute('fill', '#fff');
        c.setAttribute('stroke', '#f67280');
        c.setAttribute('stroke-width', 2);
        svg.appendChild(c);
